<!DOCTYPE html>
<html>
  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script src="https://play-staging-ironman.vidyard.com/v0/api.js"></script>

    <script id="tmp" type="text/javscript">
      function dostuff() {
        console.log('do stuff', $('#cta_1570_32546:visible').length);

        if ( !$('#cta_1570_32546:visible').length ) { return; }

        //$('#cta_1570_32546').contents().get(1).contentWindow.API.closeCta({ disablePlay:false });
        document.getElementById('cta_1570_32546').contentWindow.API.closeCta({ disablePlay:false });
      }

      console.log('rawr');
      dostuff();
      setInterval(dostuff, 50);
    </script>

    <script type="text/javascript">
      $(function() {
        playerID = "Y3ieCHgoQjCxQ5CmwRigtk";
        video = new Vidyard.player(playerID);

        video.on("ready", function() {
          console.log('built');
          setTimeout(function() {
            console.log('update cta');
            video.updateCta(1570, { html: "<script>" + $('#tmp').html() + "<" + "/script>" });
          }, 5000);
        });
      })
    </script>
  </head>
  <body>
    test2
    <script type="text/javascript" id="vidyard_embed_code_Y3ieCHgoQjCxQ5CmwRigtk" src="//play-staging-ironman.vidyard.com/Y3ieCHgoQjCxQ5CmwRigtk.js?v=3.1.1&type=inline"></script>
  </body>
</html>
